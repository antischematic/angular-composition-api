"use strict";(self.webpackChunkpackages_docs=self.webpackChunkpackages_docs||[]).push([[855],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=l(n),m=o,g=u["".concat(c,".").concat(m)]||u[m]||d[m]||a;return n?r.createElement(g,s(s({ref:t},p),{},{components:n})):r.createElement(g,s({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=u;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var l=2;l<a;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6598:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return p},default:function(){return u}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),s=["components"],i={sidebar_position:1},c="Phalanx",l={unversionedId:"store/intro",id:"store/intro",isDocsHomePage:!1,title:"Phalanx",description:"Atomic state management for Angular Composition API",source:"@site/docs/store/intro.md",sourceDirName:"store",slug:"/store/intro",permalink:"/angular-composition-api/docs/store/intro",editUrl:"https://github.com/mmuscat/angular-composition-api/tree/master/docs/store/intro.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"API",permalink:"/angular-composition-api/docs/boundary/api"}},p=[{value:"Get Started",id:"get-started",children:[]},{value:"Queries",id:"queries",children:[]},{value:"Commands",id:"commands",children:[]},{value:"Effects",id:"effects",children:[]},{value:"Stores",id:"stores",children:[]},{value:"Module Store",id:"module-store",children:[]},{value:"Component Store",id:"component-store",children:[]},{value:"Plugins",id:"plugins",children:[{value:"Store Logger",id:"store-logger",children:[]},{value:"Store Cache",id:"store-cache",children:[]}]}],d={toc:p};function u(e){var t=e.components,n=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"phalanx"},"Phalanx"),(0,a.kt)("p",null,"Atomic state management for Angular Composition API"),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"This package is still being developed, and may contain breaking changes between each release."))),(0,a.kt)("h2",{id:"get-started"},"Get Started"),(0,a.kt)("p",null,"Install via NPM"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @mmuscat/angular-phalanx\n")),(0,a.kt)("p",null,"Install via Yarn"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @mmuscat/angular-phalanx\n")),(0,a.kt)("h2",{id:"queries"},"Queries"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'const UserId = new Query("userId", () => use(EMPTY))\n\nconst Todos = new Query("todos", () => {\n   const http = inject(HttpClient)\n   return pipe(\n      inject(UserId),\n      switchMap((userId) =>\n         http.get(environment.url, {\n            params: { userId },\n         }),\n      ),\n   )\n})\n\nconst TodosError = new Query("todosError", () => {\n   const retry = inject(Retry)\n   return onError(inject(Todos), () => retry)\n})\n')),(0,a.kt)("h2",{id:"commands"},"Commands"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'const Retry = new Command("retry", (action) => {\n   return pipe(action, debounceTime(1000))\n})\n')),(0,a.kt)("h2",{id:"effects"},"Effects"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'const TodosEffect = new Effect("todosEffect", ({ event, dispatch }) => {\n   return pipe(event(Todos), pairwise(), dispatch(LogTodos))\n})\n\nconst LogTodos = new Command("logTodos", (action) => {\n   return pipe(\n      action,\n      tap(([previous, current]) =>\n         console.log("todos", {\n            previous,\n            current,\n         }),\n      ),\n   )\n})\n')),(0,a.kt)("h2",{id:"stores"},"Stores"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'const TodosStore = new Store("todos", {\n   tokens: [UserId, Todos, TodosError, Retry, LogTodos, TodosEffect],\n})\n')),(0,a.kt)("h2",{id:"module-store"},"Module Store"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"@NgModule({\n   providers: [AppStore.Provider],\n})\nexport class AppModule {}\n")),(0,a.kt)("h2",{id:"component-store"},"Component Store"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'function setup() {\n   const {\n      query: { todos, todosError },\n      command: { retry },\n   } = inject(TodosStore)\n\n   return {\n      todos,\n      todosError,\n      retry,\n   }\n}\n\n@Component({\n   selector: "todos",\n   template: `\n      <div *ngIf="todosError; else showTodos">\n         Something went wrong.\n         <button (click)="retry()">Retry</button>\n      </div>\n      <ng-template #showTodos>\n         <spinner *ngIf="!todos"></spinner>\n         <div *ngFor="let todo of todos">\n            <todo [value]="todo"></todo>\n         </div>\n      </ng-template>\n   `,\n   providers: [TodosStore.Provider],\n})\nexport class Todos extends ViewDef(setup) {}\n')),(0,a.kt)("h2",{id:"plugins"},"Plugins"),(0,a.kt)("h3",{id:"store-logger"},"Store Logger"),(0,a.kt)("p",null,"Log store events to the console"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'const AppStore = new Store("app", {\n   plugins: [StoreLog.create()],\n})\n')),(0,a.kt)("h3",{id:"store-cache"},"Store Cache"),(0,a.kt)("p",null,"Persist store state in localstorage."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'const AppStore = new Store("app", {\n   plugins: [StoreCache.create({ key: "app" })],\n})\n')))}u.isMDXComponent=!0}}]);